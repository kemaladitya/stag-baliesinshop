exports.ids = [61];
exports.modules = {

/***/ 539:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);

/* *
 * * get_list_products
 * * cart_detail
 * * manage_cart
 * * cart_manager
 */

/* harmony default export */ __webpack_exports__["default"] = ({
  list_month: ["", "Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
  get_list_products: async (self, data) => {
    try {
      const request = await self.dispatch('request', {
        url: '/api/products',
        method: 'post',
        data
      });
      request.data.results = request.data.results.map(_ => {
        if (_.express_delivery && _.express_delivery_setup) {
          _.express_delivery_setup = JSON.parse(_.express_delivery_setup);
        }

        return _;
      });

      if (request.data.status) {
        self.dispatch('setState', {
          payload: {
            key: 'products',
            data: request.data.results.sort((a, b) => b.priority - a.priority)
          }
        });
        return true;
      }

      return request.data;
    } catch (error) {
      console.error("@get_list_products |", error);
      return error;
    }
  },
  cart_detail: async (self, data) => {
    try {
      const request = await self.dispatch('request', {
        url: '/cache/cart',
        method: 'post',
        data
      });
      const cart = request.data;

      if (cart && cart.status && cart.results) {
        if (cart.results.type === 'single-order') {
          if (cart.results.items.length) {
            const list_cart = cart.results.items.map(el => {
              const search_product = self.state.products.filter(prod => prod.id === el.items[0].id);

              if (search_product.length) {
                search_product[0].select_date = true;
                search_product[0].qty = el.items[0].qty;
                return search_product[0];
              }
            });
            const cleaned_cart = list_cart.filter(el => typeof el == 'object');
            self.dispatch('setState', {
              payload: {
                key: 'cart',
                data: cleaned_cart
              }
            });
          }

          self.dispatch('setState', {
            payload: {
              key: 'notes',
              data: cart.results.notes
            }
          });
        }

        if (cart.results.type === 'rp-order') {
          if (cart.results.items.length) {
            const list_dates = cart.results.items.map(el => {
              const list_items = el.items.map(item => {
                const search_product = self.state.products.filter(prod => {
                  if (prod.id === item.id) {
                    return prod;
                  }
                });
                const _item = {
                  SKU: search_product[0].SKU,
                  detail_id: search_product[0].detail[0].detail_id,
                  discount_price: search_product[0].detail[0].discount_price,
                  id: search_product[0].id,
                  main_image: search_product[0].detail[0].main_image,
                  name: search_product[0].name,
                  normal_price: search_product[0].detail[0].normal_price,
                  product_id: search_product[0].id,
                  qty: item.qty,
                  select_date: true,
                  variant: search_product[0].detail[0].variant
                };
                return _item;
              });
              const merge_items = self.state.products.map(el => {
                const find_selected = list_items.filter(s_el => s_el.id == el.id);
                if (find_selected.length) return find_selected[0];
                const _item = {
                  SKU: el.SKU,
                  detail_id: el.detail[0].detail_id,
                  discount_price: el.detail[0].discount_price,
                  id: el.id,
                  main_image: el.detail[0].main_image,
                  name: el.name,
                  normal_price: el.detail[0].normal_price,
                  product_id: el.id,
                  qty: 0,
                  select_date: false,
                  variant: el.detail[0].variant
                };
                return _item;
              });
              return {
                date: el.delivery_date,
                delivery_time: el.delivery_time,
                items: merge_items
              };
            });
            self.dispatch('setState', {
              payload: {
                key: 'dates',
                data: list_dates
              }
            });
            self.dispatch('setState', {
              payload: {
                key: 'rp_order',
                data: true
              }
            });
          }

          self.dispatch('setState', {
            payload: {
              key: 'notes',
              data: cart.results.notes
            }
          });
        }
      }

      return request.data;
    } catch (error) {
      console.error("@cart_detail |", error);
    }
  },
  manage_cart: async (self, data) => {
    try {
      const request = await self.dispatch('request', {
        url: '/cache/manage/cart',
        method: 'post',
        data
      });

      if ('status' in request) {
        return request;
      } else {
        return {
          status: 404,
          data: {
            status: false
          }
        };
      }
    } catch (error) {
      console.error("@manage_cart |", error);
    }
  },
  cart_manager: async (self, data) => {
    try {
      const request = await self.$store.dispatch("request", {
        url: "/cart",
        method: "post",
        data
      });

      if (request.status === 200 && request.data) {
        self.$store.dispatch("setState", {
          payload: {
            key: "order_type",
            data: request.data.type || "single-order"
          }
        });
        const order_type = self.$store.state.order_type;

        if (order_type === "single-order") {
          self.$store.dispatch("setState", {
            payload: {
              key: "cart",
              data: request.data.items
            }
          });
        } else if (order_type === "subscription-order") {
          self.$store.dispatch("setState", {
            payload: {
              key: "subscription_cart",
              data: request.data.items
            }
          });
        } else if (order_type === "package-order") {
          self.$store.dispatch("setState", {
            payload: {
              key: "package_cart",
              data: request.data.items
            }
          });
        }

        return request.data;
      }
    } catch (error) {
      console.error("@cart_manager |", error);
      return null;
    }
  }
});

/***/ })

};;
//# sourceMappingURL=general.js.map